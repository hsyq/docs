<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>应用程序日志 | 昆吾</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="整理的一些常用工具的中文文档，包括pm2，log4js，sequelize，mongoose">
    <meta name="keywords" content="PM2中文文档，log4js中文文档，mongoose中文文档，sequelize中文文档">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.1f2884e9.js" as="script"><link rel="preload" href="/assets/js/2.b49b8210.js" as="script"><link rel="preload" href="/assets/js/21.cb5f3751.js" as="script"><link rel="prefetch" href="/assets/js/10.4025f27b.js"><link rel="prefetch" href="/assets/js/11.32186530.js"><link rel="prefetch" href="/assets/js/12.0ef2396c.js"><link rel="prefetch" href="/assets/js/13.bf814053.js"><link rel="prefetch" href="/assets/js/14.fbc6dd44.js"><link rel="prefetch" href="/assets/js/15.41595790.js"><link rel="prefetch" href="/assets/js/16.677edfba.js"><link rel="prefetch" href="/assets/js/17.aab227dc.js"><link rel="prefetch" href="/assets/js/18.7230f4ef.js"><link rel="prefetch" href="/assets/js/19.6fbbda8b.js"><link rel="prefetch" href="/assets/js/20.f9f2c2ab.js"><link rel="prefetch" href="/assets/js/22.0146c092.js"><link rel="prefetch" href="/assets/js/23.55704b01.js"><link rel="prefetch" href="/assets/js/24.004d768d.js"><link rel="prefetch" href="/assets/js/25.01a20caa.js"><link rel="prefetch" href="/assets/js/26.2018fcb9.js"><link rel="prefetch" href="/assets/js/27.4ec5e05d.js"><link rel="prefetch" href="/assets/js/28.34775eeb.js"><link rel="prefetch" href="/assets/js/29.e10160b6.js"><link rel="prefetch" href="/assets/js/3.8f8980d1.js"><link rel="prefetch" href="/assets/js/30.e5b98ca4.js"><link rel="prefetch" href="/assets/js/31.edb11575.js"><link rel="prefetch" href="/assets/js/32.93c8f36d.js"><link rel="prefetch" href="/assets/js/33.e1ee2ee7.js"><link rel="prefetch" href="/assets/js/34.eed71f19.js"><link rel="prefetch" href="/assets/js/35.7ed85f6f.js"><link rel="prefetch" href="/assets/js/36.cc4aefa9.js"><link rel="prefetch" href="/assets/js/37.bd564fd0.js"><link rel="prefetch" href="/assets/js/38.e4fc3829.js"><link rel="prefetch" href="/assets/js/39.283e8f1d.js"><link rel="prefetch" href="/assets/js/4.b7d0708f.js"><link rel="prefetch" href="/assets/js/40.ed01af99.js"><link rel="prefetch" href="/assets/js/41.8c863263.js"><link rel="prefetch" href="/assets/js/42.16bb9938.js"><link rel="prefetch" href="/assets/js/5.9e2f4ca7.js"><link rel="prefetch" href="/assets/js/6.c7b54f12.js"><link rel="prefetch" href="/assets/js/7.5ba8cdaa.js"><link rel="prefetch" href="/assets/js/8.bbaaa56f.js"><link rel="prefetch" href="/assets/js/9.f62ee2e9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">昆吾</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/pm2/" class="nav-link router-link-active">
  PM2
</a></div><div class="nav-item"><a href="/log4js/" class="nav-link">
  Log4js
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="博客" class="mobile-dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/hsyq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.yuque.com/kunwu-mi1a0" target="_blank" rel="noopener noreferrer" class="nav-link external">
  语雀
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/3878732751440253/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/hsyq/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/pm2/" class="nav-link router-link-active">
  PM2
</a></div><div class="nav-item"><a href="/log4js/" class="nav-link">
  Log4js
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="博客" class="mobile-dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/hsyq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.yuque.com/kunwu-mi1a0" target="_blank" rel="noopener noreferrer" class="nav-link external">
  语雀
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/3878732751440253/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/hsyq/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>PM2中文文档</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pm2/1.quickstart/1.快速开始.html" class="sidebar-link">PM2 进程管理快速入门</a></li><li><a href="/pm2/2.general/1.进程管理.html" class="sidebar-link">管理应用程序状态</a></li><li><a href="/pm2/2.general/2.重启策略.html" class="sidebar-link">重启策略</a></li><li><a href="/pm2/2.general/3.日志.html" class="active sidebar-link">应用程序日志</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pm2/2.general/3.日志.html#应用程序日志" class="sidebar-link">应用程序日志</a></li><li class="sidebar-sub-header"><a href="/pm2/2.general/3.日志.html#日志大小限制" class="sidebar-link">日志大小限制</a></li><li class="sidebar-sub-header"><a href="/pm2/2.general/3.日志.html#清洗日志" class="sidebar-link">清洗日志</a></li><li class="sidebar-sub-header"><a href="/pm2/2.general/3.日志.html#应用程序日志选项" class="sidebar-link">应用程序日志选项</a></li><li class="sidebar-sub-header"><a href="/pm2/2.general/3.日志.html#自己补充" class="sidebar-link">自己补充</a></li></ul></li><li><a href="/pm2/2.general/4.持久化应用.html" class="sidebar-link">持久应用：启动脚本生成器</a></li><li><a href="/pm2/2.general/5.配置文件.html" class="sidebar-link">配置文件</a></li><li><a href="/pm2/2.general/6.集群模式.html" class="sidebar-link">Cluster模式</a></li><li><a href="/pm2/2.general/7.PM2作为静态服务器.html" class="sidebar-link">/pm2/2.general/7.PM2作为静态服务器.html</a></li><li><a href="/pm2/2.general/8.部署系统.html" class="sidebar-link">/pm2/2.general/8.部署系统.html</a></li><li><a href="/pm2/2.general/9.环境变量.html" class="sidebar-link">/pm2/2.general/9.环境变量.html</a></li><li><a href="/pm2/2.general/10.升级PM2.html" class="sidebar-link">/pm2/2.general/10.升级PM2.html</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="应用程序日志"><a href="#应用程序日志" class="header-anchor">#</a> 应用程序日志</h2> <p>使用 PM2 启动应用程序后，您可以轻松查阅和管理日志。</p> <p>默认情况下，日志文件位于<code>$HOME/.pm2/logs</code>文件夹中。</p> <h3 id="日志视图"><a href="#日志视图" class="header-anchor">#</a> 日志视图</h3> <p>要显示应用程序的日志，您可以使用<code>pm2 logs</code>命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>❯ pm2 logs -h

  Usage: logs <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>id<span class="token operator">|</span>name<span class="token operator">|</span>namespace<span class="token punctuation">]</span>

  stream logs file. Default stream all logs

  Options:

    --json                以json格式输出
    --format              格式化日志输出
    --raw                 以原始格式输出
    --err                 只显示错误日志
    --out                 只显示标准输出日志
    --lines <span class="token operator">&lt;</span>n<span class="token operator">&gt;</span>           输出最后N行，而不是默认的最后15行
    --timestamp <span class="token punctuation">[</span>format<span class="token punctuation">]</span>  每条日志记录添加时间戳（默认格式YYYY-MM-DD-HH:MM:ss）
    --nostream            打印日志而不启动日志流
    --highlight <span class="token punctuation">[</span>value<span class="token punctuation">]</span>   高亮给定的值
    -h, --help            显示帮助信息
</code></pre></div><p>一些重要的命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 实时展示所有应用的日志</span>
pm2 logs

<span class="token comment"># 实时展示api这个应用的日志</span>
pm2 logs api

<span class="token comment"># 使用json格式实时展示日志，不输出旧日志，只输出新产生的日志</span>
pm2 logs --json

<span class="token comment"># 输出最近的1000行日志信息，并实时展示新的</span>
pm2 logs big-api --lines <span class="token number">1000</span>
</code></pre></div><p>您还可以使用 CLI 仪表板检查日志：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>pm2 monit
</code></pre></div><h2 id="日志大小限制"><a href="#日志大小限制" class="header-anchor">#</a> 日志大小限制</h2> <p><a href="https://github.com/keymetrics/pm2-logrotate" target="_blank" rel="noopener noreferrer">pm2-logrotate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>模块使用磁盘上的有限空间自动切割并保留所有日志文件。</p> <p>安装：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>pm2 <span class="token function">install</span> pm2-logrotate
</code></pre></div><p><a href="https://github.com/pm2-hive/pm2-logrotate#configure" target="_blank" rel="noopener noreferrer">在此处<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>阅读有关 pm2-logrotate 的更多信息。</p> <h2 id="清洗日志"><a href="#清洗日志" class="header-anchor">#</a> 清洗日志</h2> <p>这将清空 PM2 管理的当前应用程序的日志：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 清空所有日志</span>
pm2 flush

<span class="token comment"># 清除name/id匹配&lt;api&gt;的应用程序的日志</span>
pm2 flush <span class="token operator">&lt;</span>api<span class="token operator">&gt;</span> 
</code></pre></div><h2 id="应用程序日志选项"><a href="#应用程序日志选项" class="header-anchor">#</a> 应用程序日志选项</h2> <p>启动应用程序时，您可以指定许多选项来告诉日志该如何工作。</p> <p>具体有几种不同的指定方式。</p> <h3 id="命令行界面"><a href="#命令行界面" class="header-anchor">#</a> 命令行界面</h3> <p>运行时<code>pm2 start app.js [OPTIONS]</code>时，您可以将这些选项中的任何一个传递给 CLI：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 指定out日志和error日志文件的输出路径specify filepath to output both out and error logs</span>
-l --log <span class="token punctuation">[</span>path<span class="token punctuation">]</span>

<span class="token comment"># 指定out日志的输出路径</span>
-o --output <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>

<span class="token comment"># 指定error日志的输出路径</span>
-e --error <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>

<span class="token comment"># 输出带有标准格式化时间戳的前缀日志</span>
--time

<span class="token comment"># 带有自定义格式时间戳的前缀日志</span>
--log-date-format <span class="token operator">&lt;</span>format<span class="token operator">&gt;</span>

<span class="token comment"># 使用相同的应用程序名运行多个进程时，不要按id拆分文件，即合并所有进程的日志输出到同一个文件中</span>
--merge-logs
</code></pre></div><h4 id="使用日期自动为日志添加前缀"><a href="#使用日期自动为日志添加前缀" class="header-anchor">#</a> 使用日期自动为日志添加前缀</h4> <p>通过<code>--time</code>选项，可以轻松为应用程序日志添加前缀：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ pm2 start app.js --time
<span class="token comment"># Or a running app</span>
$ pm2 restart app --time
</code></pre></div><h3 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h3> <p>通过配置文件，您可以传递以下选项：</p> <table><thead><tr><th style="text-align:left;">场地</th> <th style="text-align:center;">类型</th> <th style="text-align:center;">例子</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">error_file</td> <td style="text-align:center;">（string）</td> <td style="text-align:center;"></td> <td style="text-align:left;">错误日志路径（默认为$HOME/.pm2/logs/XXXerr.log）</td></tr> <tr><td style="text-align:left;">out_file</td> <td style="text-align:center;">（string）</td> <td style="text-align:center;"></td> <td style="text-align:left;">输出日志路径（默认为$HOME/.pm2/logs/XXXout.log）</td></tr> <tr><td style="text-align:left;">pid_file</td> <td style="text-align:center;">（string）</td> <td style="text-align:center;"></td> <td style="text-align:left;">pid 文件路径（默认为$HOME/.pm2/pid/app-pm_id.pid）</td></tr> <tr><td style="text-align:left;">merge_logs</td> <td style="text-align:center;">boolean</td> <td style="text-align:center;">true</td> <td style="text-align:left;">默认为false，设置为true后，所有进程的日志会合并到一个日志文件中</td></tr> <tr><td style="text-align:left;">log_date_format</td> <td style="text-align:center;">（string）</td> <td style="text-align:center;">“YYYY-MM-DD HH:mm Z”</td> <td style="text-align:left;">设置日志日期格式（即日志文件中每条日志记录前面的日期格式）</td></tr></tbody></table> <h3 id="禁用日志后缀"><a href="#禁用日志后缀" class="header-anchor">#</a> 禁用日志后缀</h3> <p><em>个人注：这个标题不准确。</em></p> <p>仅适用于 (node.js的) 集群模式的应用程序；如果希望集群进程的所有实例的日志都记录到到同一个文件中，您可以使用该选项<code>--merge-logs</code>或<code>merge_logs: true</code>。</p> <h3 id="禁用日志"><a href="#禁用日志" class="header-anchor">#</a> 禁用日志</h3> <p>要禁止日志写入磁盘，可以将选项<code>out_file</code>和<code>error_file</code>设为<code>/dev/null</code>：</p> <div class="language- extra-class"><pre class="language-text"><code>module.exports = {
  apps : [{
    name: 'Business News Watcher',
    script: 'app.js',
    instances: 1,
    out_file: &quot;/dev/null&quot;,
    error_file: &quot;/dev/null&quot;
    cron_restart: '0 0 * * *'
    [...]
  }]
}
</code></pre></div><p>您可以提供<code>/dev/null</code>或<code>NULL</code>作为日志的输出（不取决于平台，它们是硬编码字符串）。</p> <h3 id="使用原生-logrotate"><a href="#使用原生-logrotate" class="header-anchor">#</a> 使用原生 logrotate</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> pm2 <span class="token function">logrotate</span> -u user
</code></pre></div><p>这将写入一个基本的 logrotate 配置<code>/etc/logrotate.d/pm2-user</code>，如下所示：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>/home/user/.pm2/pm2.log /home/user/.pm2/logs/*.log <span class="token punctuation">{</span>        rotate <span class="token number">12</span>        weekly        missingok        notifempty        compress        delaycompress        create 0640 user user<span class="token punctuation">}</span>
</code></pre></div><h2 id="自己补充"><a href="#自己补充" class="header-anchor">#</a> 自己补充</h2> <p>pm2的日志模块默认为每一个服务进程都分配两个默认的日志文件：</p> <ul><li>out.log：记录应用中的<code>console.log</code>输出</li> <li>error.log：错误日志，记录应用运行报错的信息</li></ul> <p>这两个日志文件存默认放于<code>$HOME/.pm2/logs</code>中。</p> <p>默认，pm2会为应用的每个进程都创建各自的日志，例如，假设pm2管理的某个应用有5个进程，那么日志文件夹下将会生成10个日志文件。</p> <p><code>pm2 log</code> 命令等同于<code>pm2 logs</code>。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">4/9/2022, 2:55:55 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pm2/2.general/2.重启策略.html" class="prev">
        重启策略
      </a></span> <span class="next"><a href="/pm2/2.general/4.持久化应用.html">
        持久应用：启动脚本生成器
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1f2884e9.js" defer></script><script src="/assets/js/2.b49b8210.js" defer></script><script src="/assets/js/21.cb5f3751.js" defer></script>
  </body>
</html>
